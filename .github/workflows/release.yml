name: Release
on:
  push:
    branches: ['release']
permissions:
  contents: write

jobs:
  test:
    name: Test
    uses: ./.github/workflows/test.yml

  release:
    name: Release
    needs: test
    uses: ./.github/workflows/build-tauri-app.yml
    with:
      tagName: __VERSION__
      releaseName: Resolute v__VERSION__
      releaseDraft: true
      includeUpdaterJson: true
      updaterJsonPreferNsis: true
    secrets:
      updaterKey: ${{ secrets.TAURI_UPDATER_KEY }}
      updaterKeyPassword: ${{ secrets.TAURI_UPDATER_KEY_PASSWORD }}
